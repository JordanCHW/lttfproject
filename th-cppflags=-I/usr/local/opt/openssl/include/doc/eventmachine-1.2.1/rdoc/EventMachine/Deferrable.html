<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

  <title>Module: EventMachine::Deferrable</title>

  <link rel="stylesheet" href="../rdoc.css" type="text/css" media="screen" />

  <script src="../js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="module">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../index.html">Home</a>
          <a href="../index.html#classes">Classes</a>
          <a href="../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="../lib/em/deferrable_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/em/deferrable.rb">lib/em/deferrable.rb</a></li>
          
            <li><a href="../lib/em/future_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/em/future.rb">lib/em/future.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      

      

      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-future">::future</a></li>
          
          <li><a href="#method-i-callback">#callback</a></li>
          
          <li><a href="#method-i-cancel_callback">#cancel_callback</a></li>
          
          <li><a href="#method-i-cancel_errback">#cancel_errback</a></li>
          
          <li><a href="#method-i-cancel_timeout">#cancel_timeout</a></li>
          
          <li><a href="#method-i-errback">#errback</a></li>
          
          <li><a href="#method-i-fail">#fail</a></li>
          
          <li><a href="#method-i-set_deferred_failure">#set_deferred_failure</a></li>
          
          <li><a href="#method-i-set_deferred_status">#set_deferred_status</a></li>
          
          <li><a href="#method-i-set_deferred_success">#set_deferred_success</a></li>
          
          <li><a href="#method-i-succeed">#succeed</a></li>
          
          <li><a href="#method-i-timeout">#timeout</a></li>
          
        </ul>
      </div>
      

      
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Files</h3>
        <ul>
        
          <li class="file"><a href="../docs/old/ChangeLog.html">ChangeLog</a></li>
        
          <li class="file"><a href="../docs/old/DEFERRABLES.html">DEFERRABLES</a></li>
        
          <li class="file"><a href="../docs/old/EPOLL.html">EPOLL</a></li>
        
          <li class="file"><a href="../docs/old/INSTALL.html">INSTALL</a></li>
        
          <li class="file"><a href="../docs/old/KEYBOARD.html">KEYBOARD</a></li>
        
          <li class="file"><a href="../docs/old/LEGAL.html">LEGAL</a></li>
        
          <li class="file"><a href="../docs/old/LIGHTWEIGHT_CONCURRENCY.html">LIGHTWEIGHT_CONCURRENCY</a></li>
        
          <li class="file"><a href="../docs/old/PURE_RUBY.html">PURE_RUBY</a></li>
        
          <li class="file"><a href="../docs/old/RELEASE_NOTES.html">RELEASE_NOTES</a></li>
        
          <li class="file"><a href="../docs/old/SMTP.html">SMTP</a></li>
        
          <li class="file"><a href="../docs/old/SPAWNED_PROCESSES.html">SPAWNED_PROCESSES</a></li>
        
          <li class="file"><a href="../docs/old/TODO.html">TODO</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../EventMachine.html">EventMachine</a></li>
        
          <li><a href="../EventMachine.html">EventMachine</a></li>
        
          <li><a href="../EventMachine/CertificateCreator.html">EventMachine::CertificateCreator</a></li>
        
          <li><a href="../EventMachine/Channel.html">EventMachine::Channel</a></li>
        
          <li><a href="../EventMachine/Completion.html">EventMachine::Completion</a></li>
        
          <li><a href="../EventMachine/Connection.html">EventMachine::Connection</a></li>
        
          <li><a href="../EventMachine/ConnectionError.html">EventMachine::ConnectionError</a></li>
        
          <li><a href="../EventMachine/ConnectionNotBound.html">EventMachine::ConnectionNotBound</a></li>
        
          <li><a href="../EventMachine/DNS.html">EventMachine::DNS</a></li>
        
          <li><a href="../EventMachine/DNS/Request.html">EventMachine::DNS::Request</a></li>
        
          <li><a href="../EventMachine/DNS/RequestIdAlreadyUsed.html">EventMachine::DNS::RequestIdAlreadyUsed</a></li>
        
          <li><a href="../EventMachine/DNS/Resolver.html">EventMachine::DNS::Resolver</a></li>
        
          <li><a href="../EventMachine/DNS/Socket.html">EventMachine::DNS::Socket</a></li>
        
          <li><a href="../EventMachine/DatagramObject.html">EventMachine::DatagramObject</a></li>
        
          <li><a href="../EventMachine/DefaultDeferrable.html">EventMachine::DefaultDeferrable</a></li>
        
          <li><a href="../EventMachine/Deferrable.html">EventMachine::Deferrable</a></li>
        
          <li><a href="../EventMachine/DeferrableChildProcess.html">EventMachine::DeferrableChildProcess</a></li>
        
          <li><a href="../EventMachine/Error.html">EventMachine::Error</a></li>
        
          <li><a href="../EventMachine/EvmaKeyboard.html">EventMachine::EvmaKeyboard</a></li>
        
          <li><a href="../EventMachine/EvmaTCPClient.html">EventMachine::EvmaTCPClient</a></li>
        
          <li><a href="../EventMachine/EvmaTCPServer.html">EventMachine::EvmaTCPServer</a></li>
        
          <li><a href="../EventMachine/EvmaUDPSocket.html">EventMachine::EvmaUDPSocket</a></li>
        
          <li><a href="../EventMachine/EvmaUNIXClient.html">EventMachine::EvmaUNIXClient</a></li>
        
          <li><a href="../EventMachine/EvmaUNIXServer.html">EventMachine::EvmaUNIXServer</a></li>
        
          <li><a href="../EventMachine/FileNotFoundException.html">EventMachine::FileNotFoundException</a></li>
        
          <li><a href="../EventMachine/FileStreamer.html">EventMachine::FileStreamer</a></li>
        
          <li><a href="../EventMachine/FileWatch.html">EventMachine::FileWatch</a></li>
        
          <li><a href="../EventMachine/Iterator.html">EventMachine::Iterator</a></li>
        
          <li><a href="../EventMachine/LoopbreakReader.html">EventMachine::LoopbreakReader</a></li>
        
          <li><a href="../EventMachine/PeriodicTimer.html">EventMachine::PeriodicTimer</a></li>
        
          <li><a href="../EventMachine/Pool.html">EventMachine::Pool</a></li>
        
          <li><a href="../EventMachine/ProcessWatch.html">EventMachine::ProcessWatch</a></li>
        
          <li><a href="../EventMachine/Protocols.html">EventMachine::Protocols</a></li>
        
          <li><a href="../EventMachine/Protocols.html">EventMachine::Protocols</a></li>
        
          <li><a href="../EventMachine/Protocols/HeaderAndContentProtocol.html">EventMachine::Protocols::HeaderAndContentProtocol</a></li>
        
          <li><a href="../EventMachine/Protocols/HttpClient.html">EventMachine::Protocols::HttpClient</a></li>
        
          <li><a href="../EventMachine/Protocols/HttpClient2.html">EventMachine::Protocols::HttpClient2</a></li>
        
          <li><a href="../EventMachine/Protocols/HttpClient2/Request.html">EventMachine::Protocols::HttpClient2::Request</a></li>
        
          <li><a href="../EventMachine/Protocols/LineAndTextProtocol.html">EventMachine::Protocols::LineAndTextProtocol</a></li>
        
          <li><a href="../EventMachine/Protocols/LineProtocol.html">EventMachine::Protocols::LineProtocol</a></li>
        
          <li><a href="../EventMachine/Protocols/LineText2.html">EventMachine::Protocols::LineText2</a></li>
        
          <li><a href="../EventMachine/Protocols/Memcache.html">EventMachine::Protocols::Memcache</a></li>
        
          <li><a href="../EventMachine/Protocols/Memcache/ParserError.html">EventMachine::Protocols::Memcache::ParserError</a></li>
        
          <li><a href="../EventMachine/Protocols/ObjectProtocol.html">EventMachine::Protocols::ObjectProtocol</a></li>
        
          <li><a href="../EventMachine/Protocols/Postgres3.html">EventMachine::Protocols::Postgres3</a></li>
        
          <li><a href="../EventMachine/Protocols/SASLauth.html">EventMachine::Protocols::SASLauth</a></li>
        
          <li><a href="../EventMachine/Protocols/SASLauthclient.html">EventMachine::Protocols::SASLauthclient</a></li>
        
          <li><a href="../EventMachine/Protocols/SmtpClient.html">EventMachine::Protocols::SmtpClient</a></li>
        
          <li><a href="../EventMachine/Protocols/SmtpServer.html">EventMachine::Protocols::SmtpServer</a></li>
        
          <li><a href="../EventMachine/Protocols/Socks4.html">EventMachine::Protocols::Socks4</a></li>
        
          <li><a href="../EventMachine/Protocols/Stomp.html">EventMachine::Protocols::Stomp</a></li>
        
          <li><a href="../EventMachine/Protocols/Stomp/Message.html">EventMachine::Protocols::Stomp::Message</a></li>
        
          <li><a href="../EventMachine/Protocols/TcpConnectTester.html">EventMachine::Protocols::TcpConnectTester</a></li>
        
          <li><a href="../EventMachine/Queue.html">EventMachine::Queue</a></li>
        
          <li><a href="../EventMachine/Reactor.html">EventMachine::Reactor</a></li>
        
          <li><a href="../EventMachine/Selectable.html">EventMachine::Selectable</a></li>
        
          <li><a href="../EventMachine/SpawnedProcess.html">EventMachine::SpawnedProcess</a></li>
        
          <li><a href="../EventMachine/StreamObject.html">EventMachine::StreamObject</a></li>
        
          <li><a href="../EventMachine/SystemCmd.html">EventMachine::SystemCmd</a></li>
        
          <li><a href="../EventMachine/ThreadedResource.html">EventMachine::ThreadedResource</a></li>
        
          <li><a href="../EventMachine/TickLoop.html">EventMachine::TickLoop</a></li>
        
          <li><a href="../EventMachine/Timer.html">EventMachine::Timer</a></li>
        
          <li><a href="../EventMachine/UnknownTimerFired.html">EventMachine::UnknownTimerFired</a></li>
        
          <li><a href="../EventMachine/Unsupported.html">EventMachine::Unsupported</a></li>
        
          <li><a href="../EventMachine/UuidGenerator.html">EventMachine::UuidGenerator</a></li>
        
          <li><a href="../EventMachine/YieldBlockFromSpawnedProcess.html">EventMachine::YieldBlockFromSpawnedProcess</a></li>
        
          <li><a href="../Object.html">Object</a></li>
        
          <li><a href="../EventMachine.html">Object::EM</a></li>
        
          <li><a href="../EventMachine/Protocols.html">Object::P</a></li>
        
          <li><a href="../BufferedTokenizer.html">BufferedTokenizer</a></li>
        
          <li><a href="../IO.html">IO</a></li>
        
          <li><a href="../StringIO.html">StringIO</a></li>
        
          <li><a href="../TestConnection.html">TestConnection</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="module">EventMachine::Deferrable</h1>

    <div id="description" class="description">
      
    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      

      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="future-method" class="method-detail ">
          <a name="method-c-future"></a>

          
          <div class="method-heading">
            <span class="method-name">future</span><span
              class="method-args">(arg, cb=nil, eb=nil, &blk)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>A future is a sugaring of a typical deferrable usage.</p>
            

            
            <div class="method-source-code" id="future-source">
<pre>
<span class="ruby-comment"># File lib/em/future.rb, line 44</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">future</span> <span class="ruby-identifier">arg</span>, <span class="ruby-identifier">cb</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">eb</span>=<span class="ruby-keyword">nil</span>, &amp;<span class="ruby-identifier">blk</span>
  <span class="ruby-identifier">arg</span> = <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">call</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:call</span>)

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:set_deferred_status</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">cb</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">eb</span>
      <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">callback</span>(&amp;<span class="ruby-identifier">cb</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">cb</span>
      <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">errback</span>(&amp;<span class="ruby-identifier">eb</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">eb</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">callback</span>(&amp;<span class="ruby-identifier">blk</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">blk</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">arg</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- future-source -->
            
          </div>

          

          
        </div><!-- future-method -->

      
      </div><!-- public-class-method-details -->
    
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="callback-method" class="method-detail ">
          <a name="method-i-callback"></a>

          
          <div class="method-heading">
            <span class="method-name">callback</span><span
              class="method-args">(&block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Specify a block to be executed if and when the <a
href="Deferrable.html">Deferrable</a> object receives a status of
:succeeded. See <a
href="Deferrable.html#method-i-set_deferred_status">set_deferred_status</a>
for more information.</p>

<p>Calling this method on a <a href="Deferrable.html">Deferrable</a> object
whose status is not yet known will cause the callback block to be stored on
an internal list. If you call this method on a <a
href="Deferrable.html">Deferrable</a> whose status is :succeeded, the block
will be executed immediately, receiving the parameters given to the prior
<a
href="Deferrable.html#method-i-set_deferred_status">set_deferred_status</a>
call.</p>
            

            
            <div class="method-source-code" id="callback-source">
<pre>
<span class="ruby-comment"># File lib/em/deferrable.rb, line 44</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">callback</span> &amp;<span class="ruby-identifier">block</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">block</span>
  <span class="ruby-ivar">@deferred_status</span> <span class="ruby-operator">||=</span> <span class="ruby-value">:unknown</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@deferred_status</span> <span class="ruby-operator">==</span> <span class="ruby-value">:succeeded</span>
    <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(*<span class="ruby-ivar">@deferred_args</span>)
  <span class="ruby-keyword">elsif</span> <span class="ruby-ivar">@deferred_status</span> <span class="ruby-operator">!=</span> <span class="ruby-value">:failed</span>
    <span class="ruby-ivar">@callbacks</span> <span class="ruby-operator">||=</span> []
    <span class="ruby-ivar">@callbacks</span>.<span class="ruby-identifier">unshift</span> <span class="ruby-identifier">block</span> <span class="ruby-comment"># &lt;&lt; block</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- callback-source -->
            
          </div>

          

          
        </div><!-- callback-method -->

      
        <div id="cancel_callback-method" class="method-detail ">
          <a name="method-i-cancel_callback"></a>

          
          <div class="method-heading">
            <span class="method-name">cancel_callback</span><span
              class="method-args">(block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Cancels an outstanding callback to &amp;block if any. Undoes the action of
<a href="Deferrable.html#method-i-callback">callback</a>.</p>
            

            
            <div class="method-source-code" id="cancel_callback-source">
<pre>
<span class="ruby-comment"># File lib/em/deferrable.rb, line 58</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">cancel_callback</span> <span class="ruby-identifier">block</span>
  <span class="ruby-ivar">@callbacks</span> <span class="ruby-operator">||=</span> []
  <span class="ruby-ivar">@callbacks</span>.<span class="ruby-identifier">delete</span> <span class="ruby-identifier">block</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- cancel_callback-source -->
            
          </div>

          

          
        </div><!-- cancel_callback-method -->

      
        <div id="cancel_errback-method" class="method-detail ">
          <a name="method-i-cancel_errback"></a>

          
          <div class="method-heading">
            <span class="method-name">cancel_errback</span><span
              class="method-args">(block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Cancels an outstanding errback to &amp;block if any. Undoes the action of
<a href="Deferrable.html#method-i-errback">errback</a>.</p>
            

            
            <div class="method-source-code" id="cancel_errback-source">
<pre>
<span class="ruby-comment"># File lib/em/deferrable.rb, line 84</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">cancel_errback</span> <span class="ruby-identifier">block</span>
  <span class="ruby-ivar">@errbacks</span> <span class="ruby-operator">||=</span> []
  <span class="ruby-ivar">@errbacks</span>.<span class="ruby-identifier">delete</span> <span class="ruby-identifier">block</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- cancel_errback-source -->
            
          </div>

          

          
        </div><!-- cancel_errback-method -->

      
        <div id="cancel_timeout-method" class="method-detail ">
          <a name="method-i-cancel_timeout"></a>

          
          <div class="method-heading">
            <span class="method-name">cancel_timeout</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Cancels an outstanding timeout if any. Undoes the action of <a
href="Deferrable.html#method-i-timeout">timeout</a>.</p>
            

            
            <div class="method-source-code" id="cancel_timeout-source">
<pre>
<span class="ruby-comment"># File lib/em/deferrable.rb, line 179</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">cancel_timeout</span>
  <span class="ruby-ivar">@deferred_timeout</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@deferred_timeout</span>
    <span class="ruby-ivar">@deferred_timeout</span>.<span class="ruby-identifier">cancel</span>
    <span class="ruby-ivar">@deferred_timeout</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- cancel_timeout-source -->
            
          </div>

          

          
        </div><!-- cancel_timeout-method -->

      
        <div id="errback-method" class="method-detail ">
          <a name="method-i-errback"></a>

          
          <div class="method-heading">
            <span class="method-name">errback</span><span
              class="method-args">(&block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Specify a block to be executed if and when the <a
href="Deferrable.html">Deferrable</a> object receives a status of :failed.
See <a
href="Deferrable.html#method-i-set_deferred_status">set_deferred_status</a>
for more information.</p>
            

            
            <div class="method-source-code" id="errback-source">
<pre>
<span class="ruby-comment"># File lib/em/deferrable.rb, line 70</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">errback</span> &amp;<span class="ruby-identifier">block</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">block</span>
  <span class="ruby-ivar">@deferred_status</span> <span class="ruby-operator">||=</span> <span class="ruby-value">:unknown</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@deferred_status</span> <span class="ruby-operator">==</span> <span class="ruby-value">:failed</span>
    <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(*<span class="ruby-ivar">@deferred_args</span>)
  <span class="ruby-keyword">elsif</span> <span class="ruby-ivar">@deferred_status</span> <span class="ruby-operator">!=</span> <span class="ruby-value">:succeeded</span>
    <span class="ruby-ivar">@errbacks</span> <span class="ruby-operator">||=</span> []
    <span class="ruby-ivar">@errbacks</span>.<span class="ruby-identifier">unshift</span> <span class="ruby-identifier">block</span> <span class="ruby-comment"># &lt;&lt; block</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- errback-source -->
            
          </div>

          

          
        </div><!-- errback-method -->

      
        <div id="fail-method" class="method-detail ">
          <a name="method-i-fail"></a>

          
          <div class="method-heading">
            <span class="method-name">fail</span><span
              class="method-args">(*args)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sugar for <a
href="Deferrable.html#method-i-set_deferred_status">set_deferred_status</a>(:failed,
…)</p>
            

            
            <div class="method-source-code" id="fail-source">
<pre>
<span class="ruby-comment"># File lib/em/deferrable.rb, line 197</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">fail</span> *<span class="ruby-identifier">args</span>
  <span class="ruby-identifier">set_deferred_status</span> <span class="ruby-value">:failed</span>, *<span class="ruby-identifier">args</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- fail-source -->
            
          </div>

          
          <div class="aliases">
            Also aliased as: <a href="Deferrable.html#method-i-set_deferred_failure">set_deferred_failure</a>
          </div>
          

          
        </div><!-- fail-method -->

      
        <div id="set_deferred_failure-method" class="method-detail method-alias">
          <a name="method-i-set_deferred_failure"></a>

          
          <div class="method-heading">
            <span class="method-name">set_deferred_failure</span><span
              class="method-args">(*args)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
          </div>

          

          
          <div class="aliases">
            Alias for: <a href="Deferrable.html#method-i-fail">fail</a>
          </div>
          
        </div><!-- set_deferred_failure-method -->

      
        <div id="set_deferred_status-method" class="method-detail ">
          <a name="method-i-set_deferred_status"></a>

          
          <div class="method-heading">
            <span class="method-name">set_deferred_status</span><span
              class="method-args">(status, *args)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sets the “disposition” (status) of the <a
href="Deferrable.html">Deferrable</a> object. See also the large set of
sugarings for this method. Note that if you call this method without
arguments, no arguments will be passed to the callback/errback. If the user
has coded these with arguments, then the user code will throw an argument
exception. Implementors of deferrable classes <b>must</b> document the
arguments they will supply to user callbacks.</p>

<p>OBSERVE SOMETHING VERY SPECIAL here: you may call this method even on the
INSIDE of a callback. This is very useful when a previously-registered
callback wants to change the parameters that will be passed to
subsequently-registered ones.</p>

<p>You may give either :succeeded or :failed as the status argument.</p>

<p>If you pass :succeeded, then all of the blocks passed to the object using
the <a href="Deferrable.html#method-i-callback">callback</a> method (if
any) will be executed BEFORE the <a
href="Deferrable.html#method-i-set_deferred_status">set_deferred_status</a>
method returns. All of the blocks passed to the object using <a
href="Deferrable.html#method-i-errback">errback</a> will be discarded.</p>

<p>If you pass :failed, then all of the blocks passed to the object using the
<a href="Deferrable.html#method-i-errback">errback</a> method (if any) will
be executed BEFORE the <a
href="Deferrable.html#method-i-set_deferred_status">set_deferred_status</a>
method returns. All of the blocks passed to the object using # callback
will be discarded.</p>

<p>If you pass any arguments to <a
href="Deferrable.html#method-i-set_deferred_status">set_deferred_status</a>
in addition to the status argument, they will be passed as arguments to any
callbacks or errbacks that are executed. It’s your responsibility to ensure
that the argument lists specified in your callbacks and errbacks match the
arguments given in calls to <a
href="Deferrable.html#method-i-set_deferred_status">set_deferred_status</a>,
otherwise Ruby will raise an ArgumentError.</p>
            

            
            <div class="method-source-code" id="set_deferred_status-source">
<pre>
<span class="ruby-comment"># File lib/em/deferrable.rb, line 141</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">set_deferred_status</span> <span class="ruby-identifier">status</span>, *<span class="ruby-identifier">args</span>
  <span class="ruby-identifier">cancel_timeout</span>
  <span class="ruby-ivar">@errbacks</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@callbacks</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@deferred_status</span> = <span class="ruby-identifier">status</span>
  <span class="ruby-ivar">@deferred_args</span> = <span class="ruby-identifier">args</span>
  <span class="ruby-keyword">case</span> <span class="ruby-ivar">@deferred_status</span>
  <span class="ruby-keyword">when</span> <span class="ruby-value">:succeeded</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@callbacks</span>
      <span class="ruby-keyword">while</span> <span class="ruby-identifier">cb</span> = <span class="ruby-ivar">@callbacks</span>.<span class="ruby-identifier">pop</span>
        <span class="ruby-identifier">cb</span>.<span class="ruby-identifier">call</span>(*<span class="ruby-ivar">@deferred_args</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-ivar">@errbacks</span>.<span class="ruby-identifier">clear</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@errbacks</span>
  <span class="ruby-keyword">when</span> <span class="ruby-value">:failed</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@errbacks</span>
      <span class="ruby-keyword">while</span> <span class="ruby-identifier">eb</span> = <span class="ruby-ivar">@errbacks</span>.<span class="ruby-identifier">pop</span>
        <span class="ruby-identifier">eb</span>.<span class="ruby-identifier">call</span>(*<span class="ruby-ivar">@deferred_args</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-ivar">@callbacks</span>.<span class="ruby-identifier">clear</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@callbacks</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- set_deferred_status-source -->
            
          </div>

          

          
        </div><!-- set_deferred_status-method -->

      
        <div id="set_deferred_success-method" class="method-detail method-alias">
          <a name="method-i-set_deferred_success"></a>

          
          <div class="method-heading">
            <span class="method-name">set_deferred_success</span><span
              class="method-args">(*args)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
          </div>

          

          
          <div class="aliases">
            Alias for: <a href="Deferrable.html#method-i-succeed">succeed</a>
          </div>
          
        </div><!-- set_deferred_success-method -->

      
        <div id="succeed-method" class="method-detail ">
          <a name="method-i-succeed"></a>

          
          <div class="method-heading">
            <span class="method-name">succeed</span><span
              class="method-args">(*args)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sugar for <a
href="Deferrable.html#method-i-set_deferred_status">set_deferred_status</a>(:succeeded,
…)</p>
            

            
            <div class="method-source-code" id="succeed-source">
<pre>
<span class="ruby-comment"># File lib/em/deferrable.rb, line 190</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">succeed</span> *<span class="ruby-identifier">args</span>
  <span class="ruby-identifier">set_deferred_status</span> <span class="ruby-value">:succeeded</span>, *<span class="ruby-identifier">args</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- succeed-source -->
            
          </div>

          
          <div class="aliases">
            Also aliased as: <a href="Deferrable.html#method-i-set_deferred_success">set_deferred_success</a>
          </div>
          

          
        </div><!-- succeed-method -->

      
        <div id="timeout-method" class="method-detail ">
          <a name="method-i-timeout"></a>

          
          <div class="method-heading">
            <span class="method-name">timeout</span><span
              class="method-args">(seconds, *args)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Setting a timeout on a <a href="Deferrable.html">Deferrable</a> causes it
to go into the failed state after the Timeout expires (passing no arguments
to the object’s errbacks). Setting the status at any time prior to a call
to the expiration of the timeout will cause the timer to be cancelled.</p>
            

            
            <div class="method-source-code" id="timeout-source">
<pre>
<span class="ruby-comment"># File lib/em/deferrable.rb, line 170</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">timeout</span> <span class="ruby-identifier">seconds</span>, *<span class="ruby-identifier">args</span>
  <span class="ruby-identifier">cancel_timeout</span>
  <span class="ruby-identifier">me</span> = <span class="ruby-keyword">self</span>
  <span class="ruby-ivar">@deferred_timeout</span> = <span class="ruby-constant">EventMachine</span><span class="ruby-operator">::</span><span class="ruby-constant">Timer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">seconds</span>) {<span class="ruby-identifier">me</span>.<span class="ruby-identifier">fail</span>(*<span class="ruby-identifier">args</span>)}
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- timeout-source -->
            
          </div>

          

          
        </div><!-- timeout-method -->

      
      </div><!-- public-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

